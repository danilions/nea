"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[688],{2688:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var r=a(9440),s=a(8108),l=a(3924),i=a(3960),n=a(5696),o=a(4348),c=a(5970),d=a(487),u=a(7813),h=a(246);let m=s.memo(e=>{let{radius:t,mapTexture:a,bumpMapTexture:l,specularMapTexture:i,cloudsTexture:n,nightLightsTexture:c}=e,d=(0,s.useRef)(null),u=(0,s.useRef)(null);(0,h.D)(()=>{d.current&&(d.current.rotation.y+=5e-4),u.current&&(u.current.rotation.y+=8e-4)});let m=(0,s.useMemo)(()=>a&&l&&i?new o.tXL({map:a,bumpMap:l,bumpScale:.005,specularMap:i,specular:new o.Q1f("grey"),shininess:10}):null,[a,l,i]),p=(0,s.useMemo)(()=>n?new o.tXL({map:n,transparent:!0,opacity:.4,blending:o.EZo}):null,[n]),x=(0,s.useMemo)(()=>c?new o.V9B({map:c,blending:o.EZo,transparent:!0,opacity:.7}):null,[c]);return m?(0,r.jsxs)("group",{children:[(0,r.jsx)("mesh",{ref:d,rotation:[0,0,0],material:m,children:(0,r.jsx)("sphereGeometry",{args:[t,64,64]})}),p&&(0,r.jsx)("mesh",{ref:u,scale:[1.005,1.005,1.005],material:p,children:(0,r.jsx)("sphereGeometry",{args:[t,64,64]})}),x&&(0,r.jsx)("mesh",{scale:[1.001,1.001,1.001],material:x,children:(0,r.jsx)("sphereGeometry",{args:[t,64,64]})})]}):(0,r.jsxs)("mesh",{children:[(0,r.jsx)("sphereGeometry",{args:[t,32,32]}),(0,r.jsx)("meshBasicMaterial",{color:"darkblue"})]})});m.displayName="EarthModel";var p=a(9833),x=a(3063);let g=s.memo(e=>{let{airport:t,radius:a,onSelect:l}=e,{t:i}=(0,d.Bd)(),n=((e,t,a)=>{let r=Math.PI/180*(90-e),s=Math.PI/180*(t+180),l=-a*Math.sin(r)*Math.cos(s),i=a*Math.cos(r),n=a*Math.sin(r)*Math.sin(s);return new o.Pq0(l,i,n)})(t.lat,t.lng,a+.015),[u,h]=(0,s.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.iy,{position:n,args:[.03,16,16],onPointerOver:()=>h(!0),onPointerOut:()=>h(!1),onClick:()=>l(t),"aria-label":i("airport.markerLabel",{city:t.city,country:t.country}),children:(0,r.jsx)("meshBasicMaterial",{color:u?"#FFD700":"#00FFFF"})}),(0,r.jsx)(x.E,{distanceFactor:10,position:n.toArray(),zIndexRange:[100,0],children:(0,r.jsx)("button",{style:{position:"absolute",width:1,height:1,opacity:0,pointerEvents:"auto",overflow:"hidden",padding:0,margin:0,border:0,clip:"rect(0 0 0 0)",whiteSpace:"nowrap"},tabIndex:0,"aria-label":i("airport.markerLabel",{city:t.city,country:t.country}),onFocus:()=>h(!0),onBlur:()=>h(!1),onClick:()=>l(t),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),l(t))}})}),u&&(0,r.jsx)(x.E,{distanceFactor:10,position:[0,.05,0],children:(0,r.jsxs)(c.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gray-800 text-white text-xs px-2 py-1 rounded-md whitespace-nowrap opacity-90 shadow-lg border border-gray-700",style:{pointerEvents:"none",minWidth:120},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:t.iata})," - ",t.city,", ",t.country]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"ICAO:"})," ",t.icao||"-"," | ",(0,r.jsx)("span",{className:"font-semibold",children:"TZ:"})," ",t.timezone]}),t.description&&(0,r.jsx)("div",{className:"mt-1 text-gray-300",children:t.description})]})})]})});g.displayName="AirportMarker";let b=s.memo(e=>{let{airports:t=[],radius:a,onSelect:s}=e;return t&&0!==t.length?(0,r.jsx)(r.Fragment,{children:t.map(e=>(0,r.jsx)(g,{airport:e,radius:a,onSelect:s},e.iata))}):(0,r.jsx)("group",{children:(0,r.jsx)(x.E,{center:!0,position:[0,a+.2,0],children:(0,r.jsx)("div",{className:"bg-red-800 text-white px-3 py-2 rounded shadow-lg text-sm",children:"No airports found."})})})});b.displayName="AirportMarkers";let f=s.memo(e=>{let{start:t,end:a,index:l}=e,i=(0,s.useRef)(null),n=(0,s.useMemo)(()=>new o.B6O([t,t.clone().lerp(a,.5).setLength(1.15*t.length()),a]),[t,a]);return(0,h.D)(e=>{let{clock:t}=e;if(i.current){let e=(.05*t.getElapsedTime()+.02*l)%1,a=n.getPointAt(e);i.current.position.copy(a)}}),(0,r.jsxs)("group",{children:[(0,r.jsxs)("line",{children:[(0,r.jsx)("bufferGeometry",{attach:"geometry",...new o.LoY().setFromPoints(n.getPoints(50))}),(0,r.jsx)("lineBasicMaterial",{color:"#00FF00",linewidth:1,transparent:!0,opacity:.2})]}),(0,r.jsxs)("mesh",{ref:i,children:[(0,r.jsx)("sphereGeometry",{args:[.015,8,8]}),(0,r.jsx)("meshBasicMaterial",{color:"#FFFFFF"})]})]})});f.displayName="FlightPath";let y=s.memo(e=>{let{flightRoutes:t}=e;return(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsx)(f,{start:e.start,end:e.end,index:t},"".concat(e.routeInfo.source,"-").concat(e.routeInfo.target,"-").concat(t)))})});y.displayName="FlightPaths";let j=s.memo(e=>{let{numStars:t=1e4,radius:a=150,starSize:l=.15,opacity:i=.9}=e,n=(0,s.useRef)(null);if(!n.current){let e=new Float32Array(3*t);for(let r=0;r<t;r++){let t=Math.random()*Math.PI*2,s=Math.random()*Math.PI,l=a*Math.sin(s)*Math.cos(t),i=a*Math.sin(s)*Math.sin(t),n=a*Math.cos(s);e[3*r]=l,e[3*r+1]=i,e[3*r+2]=n}n.current=e}let c=(0,s.useMemo)(()=>{let e=new o.LoY;return e.setAttribute("position",new o.THS(n.current,3)),e},[]);return(0,r.jsx)("points",{geometry:c,children:(0,r.jsx)("pointsMaterial",{color:"#FFFFFF",size:l,sizeAttenuation:!0,transparent:!0,opacity:i})})});j.displayName="StarsBackground";var w=a(2686);let v=s.memo(e=>{let{isOpen:t,onClose:a,children:l,title:i}=e,n=(0,s.useRef)(null),o=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(t){var e;o.current=document.activeElement;let t=null==(e=n.current)?void 0:e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=t?t[0]:null;r&&r.focus();let s=e=>{if("Escape"===e.key)a();else if(t&&"Tab"===e.key&&t.length>0){let a=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===a&&(r.focus(),e.preventDefault()):document.activeElement===r&&(a.focus(),e.preventDefault())}};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s),o.current&&o.current.focus()}}},[t,a]),(0,r.jsx)(w.N,{children:t&&(0,r.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:(0,r.jsxs)(c.P.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},transition:{duration:.3,ease:"easeOut"},className:"bg-gray-900 rounded-lg shadow-xl p-6 max-w-md w-full border border-gray-700",ref:n,role:"document",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-700",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",id:"modal-title",children:i}),(0,r.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full p-1","aria-label":"Close modal",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"text-gray-300","aria-labelledby":"modal-title",children:l})]})})})});v.displayName="AppModal";let N=s.memo(e=>{let{onSearch:t,placeholder:a="Search...",ariaLabel:l="Enter search query"}=e,[i,n]=(0,s.useState)(""),o=(0,s.useCallback)(()=>{t(i)},[t,i]),d=(0,s.useCallback)(e=>{"Enter"===e.key&&o()},[o]);return(0,r.jsxs)("div",{className:"relative w-full max-w-sm pointer-events-auto",children:[(0,r.jsx)("input",{type:"text",placeholder:a,value:i,onChange:e=>n(e.target.value),onKeyDown:d,className:"w-full p-3 pl-10 bg-gray-800 text-white rounded-full border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200","aria-label":l}),(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)(c.P.button,{onClick:o,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-blue-400 hover:text-blue-200 transition-colors duration-200","aria-label":"Perform search",whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]})});N.displayName="AppSearchBar";let M=[{label:"דף הבית",href:"/"},{label:"אודות",href:"/about"},{label:"שפה: עברית",href:"/he"},{label:"שפה: English",href:"/en"},{label:"צור קשר",href:"/contact"}],k=()=>(0,r.jsx)("nav",{className:"fixed top-6 left-1/2 transform -translate-x-1/2 z-50 bg-black bg-opacity-60 rounded-full px-6 py-2 flex gap-4 shadow-lg backdrop-blur-md border border-gray-700",children:M.map(e=>(0,r.jsx)("a",{href:e.href,className:"text-white hover:text-yellow-400 font-semibold transition-colors duration-200 text-base",children:e.label},e.href))}),F=e=>{let{earthRadius:t,airports:a,onSelectAirport:l,flightRoutes:i,setTexturesLoaded:c,setDataError:d}=e,[u,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[g,f]=(0,s.useState)(null),[w,v]=(0,s.useState)(null),[N,M]=(0,s.useState)(null),[k,F]=(0,s.useState)([]),[P,E]=(0,s.useState)(null),S=s.useRef(!1);return(0,s.useEffect)(()=>{let e=0,t=0,a=new o.Tap,r=(t,a)=>t=>{a(t),e++,l()},s=e=>()=>{F(t=>[...t,"[Globe] Texture load error: ".concat(e)]),E("Texture failed to load: ".concat(e)),t++,l()};function l(){e+t!==5||S.current||(c(!0),S.current=!0)}a.load("/images/earth_map.jpg",r("earth_map",h),void 0,s("earth_map")),a.load("/images/earth_bump.jpg",r("earth_bump",x),void 0,s("earth_bump")),a.load("/images/earth_specular.jpg",r("earth_specular",f),void 0,s("earth_specular")),a.load("/images/earth_clouds.png",r("earth_clouds",v),void 0,s("earth_clouds")),a.load("/images/earth_night.jpg",r("earth_night",M),void 0,s("earth_night"))},[]),(0,s.useEffect)(()=>{console.log("[Globe] Texture objects:",{mapTexture:u,bumpMapTexture:p,specularMapTexture:g,cloudsTexture:w,nightLightsTexture:N}),k.length>0&&console.warn("[Globe] Some textures failed to load:",k),P&&d(P)},[u,p,g,w,N,k,P,d]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("ambientLight",{intensity:.3}),(0,r.jsx)("hemisphereLight",{intensity:.5,groundColor:2236979,color:"#eeeeff"}),(0,r.jsx)("spotLight",{position:[10,10,10],angle:.3,penumbra:.5,intensity:1.2,castShadow:!0}),(0,r.jsx)(m,{radius:t,mapTexture:u,bumpMapTexture:p,specularMapTexture:g,cloudsTexture:w,nightLightsTexture:N}),(0,r.jsx)(b,{airports:a,radius:t,onSelect:l}),(0,r.jsx)(y,{flightRoutes:i}),(0,r.jsx)(j,{numStars:1e4}),(0,r.jsx)(n.N,{enablePan:!1,enableZoom:!0,minDistance:2.5,maxDistance:10})]})},P=()=>{let e=(0,l.Ub)({maxWidth:767}),{t}=(0,d.Bd)(),[a,n]=(0,s.useState)(null),[h,m]=(0,s.useState)(null),[p,x]=(0,s.useState)([]),[g,b]=(0,s.useState)(""),[f,y]=(0,s.useState)(!0),[j,w]=(0,s.useState)(null),[M,P]=(0,s.useState)(!1);(0,s.useEffect)(()=>{y(!0),w(null),console.log("[Globe] Fetching /airports-routes.json..."),fetch("/airports-routes.json").then(e=>{if(!e.ok)throw console.error("[Globe] HTTP error:",e.status),Error("HTTP error! status: ".concat(e.status));return e.json()}).then(e=>{console.log("[Globe] Data loaded:",e),m(e),x(e.airports),y(!1)}).catch(e=>{console.error("[Globe] Failed to load airports data:",e),w(t("globe.dataLoadError",{message:e.message})),y(!1)})},[t]),(0,s.useEffect)(()=>{if(h)if(g){let e=g.toLowerCase();x(h.airports.filter(t=>{var a,r;return t.iata.toLowerCase().includes(e)||t.city.toLowerCase().includes(e)||t.country.toLowerCase().includes(e)||(null==(a=t.description)?void 0:a.toLowerCase().includes(e))||(null==(r=t.icao)?void 0:r.toLowerCase().includes(e))}))}else x(h.airports)},[g,h]);let E=(0,s.useCallback)(e=>{n(e)},[]),S=(0,s.useCallback)(e=>{b(e),n(null)},[]),L=s.useMemo(()=>{if(!h)return[];let e=h.routes.map((e,t)=>{let a=h.airports.find(t=>t.iata===e.source),r=h.airports.find(t=>t.iata===e.target);if(a&&r){let s=(90-a.lat)*(Math.PI/180),l=(a.lng+180)*(Math.PI/180),i=new o.Pq0(-2*Math.sin(s)*Math.cos(l),2*Math.cos(s),2*Math.sin(s)*Math.sin(l)),n=(90-r.lat)*(Math.PI/180),c=(r.lng+180)*(Math.PI/180);return{start:i,end:new o.Pq0(-2*Math.sin(n)*Math.cos(c),2*Math.cos(n),2*Math.sin(n)*Math.sin(c)),routeInfo:e,index:t}}return null}).filter(e=>null!==e);return console.log("[Globe] flightRoutes prepared:",e.length),e},[2,h]),C=!f&&!j&&h&&M;return e?(0,r.jsxs)("div",{className:"relative w-full min-h-48 min-h-[40vh] flex items-center justify-center bg-black mx-auto shadow-2xl border-4 border-cyan-500/30 rounded-2xl",children:[(0,r.jsx)("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-80 rounded-full pointer-events-none",style:{background:"radial-gradient(circle, rgba(0,255,255,0.18) 0%, rgba(0,0,0,0) 70%)",filter:"blur(16px)",zIndex:1},"aria-hidden":"true"}),(0,r.jsx)(u.default,{src:"/images/earth_night.jpg",alt:t("globe.mainTitle"),width:256,height:256,className:"w-64 h-64 object-contain rounded-full shadow-cyan-400/40 shadow-2xl border-2 border-cyan-400 mx-auto","aria-hidden":"true"})]}):(0,r.jsxs)("div",{className:"relative w-full min-h-48 min-h-[40vh] bg-gradient-to-br from-gray-900 to-black text-white font-inter overflow-hidden mx-auto flex items-center justify-center shadow-2xl border-4 border-cyan-500/30 rounded-2xl",children:[(0,r.jsx)("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] rounded-full pointer-events-none",style:{background:"radial-gradient(circle, rgba(0,255,255,0.18) 0%, rgba(0,0,0,0) 70%)",filter:"blur(32px)",zIndex:1},"aria-hidden":"true"}),(0,r.jsx)(k,{}),!C&&(0,r.jsxs)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-gray-950 flex flex-col items-center justify-center z-50 text-blue-400 text-2xl font-bold","aria-live":"polite","aria-busy":!C,children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500 mb-4"}),f?t("globe.loadingData"):t("globe.loadingTextures")]}),j&&(0,r.jsxs)(c.P.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-red-900 bg-opacity-75 flex items-center justify-center z-50 text-white text-xl p-4 text-center",role:"alert",children:["string"==typeof j&&j.startsWith("Texture failed to load:")?j:t("globe.dataError",{error:j}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:t("common.retry")})]}),C&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.P.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},className:"absolute top-0 left-0 w-full p-6 z-10 flex flex-col items-center space-y-4 pointer-events-none",children:[(0,r.jsx)(c.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.2},className:"flex justify-center w-full",children:(0,r.jsx)(u.default,{src:"/images/logo.svg",alt:t("common.logoAlt"),width:64,height:64,style:{marginBottom:"0.5rem"}})}),(0,r.jsx)(c.P.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-3xl font-bold tracking-widest text-center drop-shadow-lg",style:{pointerEvents:"none"},children:t("globe.mainTitle")}),(0,r.jsx)(c.P.div,{className:"w-full flex justify-center",children:(0,r.jsx)(N,{onSearch:S,placeholder:t("globe.searchPlaceholder"),ariaLabel:t("globe.searchAriaLabel")})})]}),(0,r.jsx)(i.Hl,{camera:{position:[0,0,5],fov:60},style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:(0,r.jsx)(s.Suspense,{fallback:null,children:(0,r.jsx)(F,{earthRadius:2,airports:p,onSelectAirport:E,flightRoutes:L,setTexturesLoaded:P,setDataError:w})})}),(0,r.jsx)(v,{isOpen:!!a,onClose:()=>n(null),title:a?t("globe.airportDetailsTitle",{iata:a.iata}):"",children:a&&(0,r.jsxs)("div",{dir:"ltr",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.city"),":"]})," ",a.city]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.country"),":"]})," ",a.country]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.iataCode"),":"]})," ",a.iata]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.icaoCode"),":"]})," ",a.icao||"-"]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.coordinates"),":"]})," ",a.lat,", ",a.lng]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.timezone"),":"]})," ",a.timezone]}),a.description&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("strong",{children:[t("airport.description")||"Description",":"]})," ",a.description]}),h&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("strong",{children:[t("airport.relatedRoutes"),":"]}),(0,r.jsxs)("ul",{className:"list-disc ml-6 mt-1",children:[0===h.routes.filter(e=>e.source===a.iata||e.target===a.iata).length&&(0,r.jsx)("li",{children:t("airport.noRelatedRoutes")}),h.routes.filter(e=>e.source===a.iata||e.target===a.iata).map((e,a)=>(0,r.jsxs)("li",{children:[t("route.flight"),": ",e.flight_number||"-"," | ",t("route.status"),": ",t("route.status.".concat(e.status))||e.status||"-"," | ",t("route.distance"),": ",e.distance_km?"".concat(e.distance_km," km"):"-"]},a))]})]})]})})]})]})}}}]);